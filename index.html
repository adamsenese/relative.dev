<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="An AI app development company building on the cutting-edge for mobile and desktop.">
    <meta name="keywords" content="Relative, AI, Hermes, Relative Industries, App Development, Speech-to-Text">
    <title>Relative Industries | AI apps for everyone</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico?v=3">
    <link rel="icon" type="image/png" sizes="32x32" href="images/relativefavi.png?v=3">
    <link rel="icon" type="image/png" sizes="16x16" href="images/relativefavi.png?v=3">
    <link rel="shortcut icon" href="images/relativefavi.png?v=3">
    <link rel="apple-touch-icon" href="images/relativefavi.png?v=3">
    <style>
        * { box-sizing: border-box; }

        :root {
            --bg: #EAF2FB;                 /* Softer canvas */
            --stripe-1: #F8FBFF;           /* Faint pinstripe */
            --stripe-2: #EDF4FF;           /* Faint pinstripe shadow */
            --panel: rgba(255, 255, 255, 0.82); /* Glass panel */
            --panel-mid: rgba(200, 210, 225, 0.55);
            --panel-dark: rgba(145, 158, 176, 0.7);
            --shadow: rgba(0,0,0,0.14);    /* Softer, longer shadow */
            --text: #0F141A;
            --subtext: #46505A;
            --link: #1E5FFF;               /* Modern blue */
            --aqua-blue-1: #6AA8FF;        /* Titlebar top */
            --aqua-blue-2: #2A7BFF;        /* Titlebar bottom */
            --menubar-1: rgba(255,255,255,0.85); /* Glass menubar */
            --menubar-2: rgba(233,238,245,0.75);
            --menubar-border: rgba(170,179,194,0.8);
            --menu-height: 22px;           /* early OS X */
            --radius: 12px;                /* Slightly rounder */
            --safe-top: env(safe-area-inset-top);
            --safe-right: env(safe-area-inset-right);
            --safe-bottom: env(safe-area-inset-bottom);
            --safe-left: env(safe-area-inset-left);
        }
        
        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            color: var(--text);
            font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", sans-serif;
            font-weight: 500;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
        }

        a { color: var(--link); text-decoration: none; }
        a:hover { text-decoration: underline; }

        /* Menu Bar */
        .menu-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: calc(var(--menu-height) + var(--safe-top));
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--safe-top) 8px 0 8px;
            background: linear-gradient(var(--menubar-1), var(--menubar-2));
            border-bottom: 1px solid var(--menubar-border);
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.8), 0 8px 20px rgba(0,0,0,0.05);
            backdrop-filter: saturate(130%) blur(8px);
            z-index: 10;
            user-select: none;
        }
        .menu-left, .menu-right { display: flex; align-items: center; gap: 10px; }
        .menu-left { gap: 14px; }
        .menu-item { font-size: 13px; padding: 2px 6px; border-radius: 3px; }
        .menu-item:hover { background: #BFBFBF; box-shadow: inset 0 1px 0 #FFFFFF; }
        .apple { font-weight: 700; letter-spacing: 0.02em; }
        .clock { font-size: 12px; opacity: 0.9; }

        /* Desktop */
        .desktop {
            position: relative;
            padding-top: calc(var(--menu-height) + 12px);
            padding-left: 12px;
            padding-right: 12px;
            padding-bottom: 120px;
            min-height: 100vh;
            background: repeating-linear-gradient(0deg, var(--stripe-1) 0 2px, var(--stripe-2) 2px 4px);
        }

        .desktop-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 8px 6px 12px 6px;
        }
        .desktop-header .brand-logo { height: 26px; width: auto; }
        .desktop-header .brand-tagline { font-size: 13px; color: var(--subtext); }

        /* Windows */
        .windows {
            display: grid;
            grid-template-columns: repeat(2, minmax(280px, 1fr));
                gap: 16px;
            position: relative;
            z-index: 2;
        }
        @media (max-width: 840px) { .windows { grid-template-columns: 1fr; } }
        .window.draggable { position: absolute; z-index: 4; cursor: default; }
        .window.draggable .titlebar { cursor: move; }
        @media (max-width: 840px) { .window.draggable { position: static !important; } }

        .window {
            background: var(--panel);
            border: 1px solid var(--panel-dark);
            border-radius: var(--radius);
            box-shadow: 0 12px 30px var(--shadow);
            overflow: hidden;
            backdrop-filter: saturate(140%) blur(10px);
            -webkit-backdrop-filter: saturate(140%) blur(10px);
        }
        .window.hidden { display: none; }
        .window.modal { position: fixed; left: 50%; transform: translateX(-50%); top: calc(var(--menu-height) + 24px); width: min(92vw, 560px); z-index: 5; }
        @media (max-width: 520px) { .window.modal { top: calc(var(--menu-height) + 8px); width: min(94vw, 520px); } }

        /* Brushed metal window (early OS X iTunes style) */
        .window.metal {
            background: linear-gradient(180deg, rgba(250,252,255,0.9) 0%, rgba(235,242,255,0.9) 100%);
            border-color: rgba(159,169,184,0.8);
        }
        .window.metal .titlebar {
            background: linear-gradient(180deg, #F6FAFF 0%, #DCE6F5 100%);
            border-bottom: 1px solid rgba(175,186,203,0.9);
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.9);
        }
        .window.metal .title { color: #2B3F5C; text-shadow: 0 1px 0 rgba(255,255,255,0.8); }

        /* Inactive window style */
        .window.inactive .titlebar { background: linear-gradient(#E7ECF4, #CBD7E8); border-bottom: 1px solid #A8B6CA; }
        .window.inactive .title { color: #2B3F5C; text-shadow: 0 1px 0 rgba(255,255,255,0.7); }
        .window.inactive .traffic .dot { opacity: 0.85; filter: saturate(0.9); }
        .titlebar {
            display: flex;
            align-items: center;
            gap: 8px;
            height: 22px;
            padding: 0 8px;
            background: linear-gradient(180deg, var(--aqua-blue-1) 0%, var(--aqua-blue-2) 100%);
            border-bottom: 1px solid #1B5FCC;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
        }
        .traffic {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .dot {
            width: 12px; height: 12px;
            border-radius: 50%;
            border: 1px solid #6B6B6B;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.7), 0 1px 0 rgba(0,0,0,0.05);
            position: relative;
        }
        .traffic .dot:nth-child(1) { background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9) 0 35%, transparent 36%), linear-gradient(#FF7B73, #E74C3C); }
        .traffic .dot:nth-child(2) { background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9) 0 35%, transparent 36%), linear-gradient(#FFD76A, #F2B60D); }
        .traffic .dot:nth-child(3) { background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9) 0 35%, transparent 36%), linear-gradient(#8AF08D, #34C84A); }
        .title { font-size: 12px; font-weight: 700; margin-left: 4px; color: #FFFFFF; text-shadow: 0 1px 0 rgba(0,0,0,0.25); }

        /* Desktop icons */
        .desktop-icons { position: relative; z-index: 1; }
        .icon-item { position: absolute; width: 72px; display: flex; flex-direction: column; align-items: center; gap: 2px; text-align: center; cursor: default; user-select: none; touch-action: none; }
        .icon-item.dragging { cursor: grabbing; will-change: transform; }
        .icon-thumb { width: 48px; height: 48px; object-fit: cover; border-radius: 8px; border: 1px solid #A9B4C3; background: #FFFFFF; box-shadow: 0 1px 0 rgba(255,255,255,0.7), inset 0 1px 2px rgba(0,0,0,0.06); margin: 0 auto; }
        .icon-thumb { object-fit: contain; border-radius: 0; border: none; background: transparent; box-shadow: none; filter: drop-shadow(0 2px 3px rgba(0,0,0,0.18)); }
        .icon-label { margin-top: 0; font-size: 11px; line-height: 1.1; color: #0B1B3A; text-shadow: 0 1px 0 rgba(255,255,255,0.7); }
        .icon-item:active .icon-thumb { filter: brightness(0.95); }
        @media (max-width: 520px) {
            .icon-item { position: static; display: inline-flex; flex-direction: column; align-items: center; gap: 2px; margin: 8px 10px; width: 68px; }
            .desktop-icons { display: flex; flex-wrap: wrap; gap: 4px 8px; }
        }

        .window-content { padding: 10px; background: rgba(255,255,255,0.85); }

        /* Finder window */
        .finder-toolbar { display: flex; align-items: center; gap: 8px; padding: 6px 8px; background: linear-gradient(#F7FAFF, #E7EDF6); border-bottom: 1px solid #AFBACB; }
        .finder-body { display: grid; grid-template-columns: 180px 1fr; min-height: 220px; }
        .finder-sidebar { border-right: 1px solid #D3DAE6; background: #F8FAFD; padding: 8px; }
        .finder-sidebar .side-item { padding: 6px 8px; border-radius: 6px; font-size: 12px; color: #0B1B3A; }
        .finder-sidebar .side-item.active, .finder-sidebar .side-item:hover { background: linear-gradient(#5BA1FF, #2D88FF); color: #FFFFFF; }
        .finder-content { padding: 10px; }
        .finder-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 10px; }
        .finder-item { display: flex; gap: 8px; align-items: center; padding: 8px; border: 1px solid #D3DAE6; background: #FFFFFF; border-radius: 8px; }
        .finder-item .icon { width: 28px; height: 28px; border-radius: 6px; border: 1px solid #BDBDBD; }
        /* Chess board */
        .chess-square { display:flex; align-items:center; justify-content:center; font-size:32px; font-weight:600; line-height: 1; position: relative; overflow: hidden; transition: filter 120ms ease, transform 120ms ease; }
        @media (max-width: 520px) { .chess-square { font-size:22px; } }
        .chess-square.light { background: linear-gradient(#F7FAFF, #E7EDF6); box-shadow: inset 0 1px 0 rgba(255,255,255,0.6); }
        .chess-square.dark { background: linear-gradient(#B9C6D8, #8EA0B6); color:#0B1B3A; box-shadow: inset 0 1px 0 rgba(255,255,255,0.25); }
        .chess-square.sel { outline: 2px solid #2D88FF; outline-offset: -2px; }
        .chess-square.last { box-shadow: inset 0 0 0 3px rgba(255,215,0,0.4); }
        .chess-square.target::after { content: ""; position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 12px; height: 12px; border-radius: 50%; background: rgba(45,136,255,0.55); box-shadow: 0 0 6px rgba(45,136,255,0.5); pointer-events: none; }
        .chess-square.target.capture::after { width: 18px; height: 18px; background: rgba(231,76,60,0.55); box-shadow: 0 0 6px rgba(231,76,60,0.5); }
        .chess-square.hover { filter: saturate(115%); }
        .chess-square.moved { animation: piece-pop 160ms ease; }
        .chess-square.can-move { cursor: pointer; }
        .chess-square.grab { cursor: grabbing; }
        .chess-square.sel { outline: 2px solid #2D88FF; outline-offset: -2px; }
        .chess-square.target { box-shadow: inset 0 0 0 3px rgba(45,136,255,0.5); }

        /* Egg window helpers */
        .prefs-grid { display: grid; grid-template-columns: repeat(3, minmax(120px, 1fr)); gap: 10px; }
        .pref-item { display: flex; align-items: center; gap: 8px; padding: 8px; border: 1px solid var(--panel-mid); background: #FAFCFF; }
        .apps-grid { display: grid; grid-template-columns: repeat(4, 68px); gap: 12px; }
        .app { text-align: center; }
        .app .icon-thumb { width: 44px; height: 44px; }
        .app .icon-label { font-size: 11px; }
        .app .desc { font-size: 11px; color: #555; margin-top: 2px; }
        .trash-note { font-size: 12px; color: #555; }
        blockquote.quote { margin: 0; padding: 10px 12px; background: #F7FBFF; border-left: 3px solid #2D88FF; font-size: 13px; color: #02224D; }
        .pref-item .text { display: flex; flex-direction: column; }
        .pref-item .label { font-size: 12px; font-weight: 600; color: #0B1B3A; }
        .pref-item .desc { font-size: 11px; color: #555; }

        /* List view */
        .list-view { border: 1px solid var(--panel-dark); background: rgba(255,255,255,0.9); }
        .list-row {
            display: grid;
            grid-template-columns: 36px 1.2fr 2fr;
            gap: 8px;
            align-items: center;
            padding: 8px 10px;
            border-bottom: 1px solid #E5E5E5;
        }
        .list-row:hover { background: linear-gradient(180deg, rgba(248,250,255,0.9), rgba(240,246,255,0.9)); }
        .list-row:last-child { border-bottom: 0; }
        .icon { width: 28px; height: 28px; object-fit: cover; border: 1px solid #BDBDBD; background: #FFF; }
        .primary { font-weight: 700; color: #000; font-size: 13px; }
        .secondary { color: #333; font-size: 12px; }
        .actions { display: flex; gap: 8px; margin-top: 6px; flex-wrap: wrap; }
        .aqua-btn { display: inline-flex; align-items: center; gap: 6px; padding: 9px 16px; font-size: 13px; font-weight: 700; letter-spacing: 0.2px; border-radius: 14px; text-decoration: none; line-height: 1; white-space: nowrap; transition: transform 120ms ease, filter 120ms ease; }
        .aqua-btn.primary { color: #FFFFFF; background: linear-gradient(180deg, #3D86FF 0%, #1E6FFF 100%); border: 1px solid #1B5FCC; box-shadow: 0 6px 18px rgba(30,111,255,0.26), inset 0 1px 0 rgba(255,255,255,0.65); }
        .aqua-btn.secondary { color: #0B1B3A; background: linear-gradient(180deg, #FFFFFF 0%, #EDF3FF 100%); border: 1px solid #AAB3C2; box-shadow: 0 4px 12px rgba(0,0,0,0.06), inset 0 1px 0 rgba(255,255,255,0.9); }
        .aqua-btn:hover { filter: saturate(110%); transform: translateY(-1px); }
        .aqua-btn:active { filter: saturate(98%); transform: translateY(0); }
        .aqua-btn.secondary { color: #0B1B3A; background: linear-gradient(#FFFFFF, #EAF0FA); border: 1px solid #AAB3C2; }

        /* Mobile list layout */
        @media (max-width: 520px) {
            .menu-item { font-size: 12px; }
            .menu-left .menu-extra { display: none; }
            .list-row { grid-template-columns: 28px 1fr; gap: 6px; padding: 8px; }
            .icon { width: 24px; height: 24px; }
            .primary { font-size: 12px; }
            .secondary { grid-column: 2 / 3; font-size: 11px; }
        }

        /* Creator cards (vintage) */
        .people { display: grid; grid-template-columns: repeat(2, minmax(180px, 1fr)); gap: 10px; }
        @media (max-width: 480px) { .people { grid-template-columns: 1fr; } }
        .person {
            display: flex; align-items: center; gap: 10px;
            border: 1px solid var(--panel-dark);
            background: #FFFFFF;
            padding: 8px;
        }
        .avatar { width: 36px; height: 36px; object-fit: cover; border: 1px solid #BDBDBD; }
        .handle { font-weight: 700; font-size: 13px; color: #000; }
        .action { font-size: 12px; color: #333; }

        footer { display: none; }
        /* Dock-aligned overlays */
        .dock-info { position: fixed; font-size: 12px; color: #333; z-index: 7; padding: 4px 8px; background: rgba(255,255,255,0.65); border: 1px solid rgba(170,179,194,0.6); border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.8); backdrop-filter: blur(6px) saturate(130%); }
        @media (max-width: 520px) { .dock-info { font-size: 11px; } }

        /* Menus */
        .menu-dropdown { position: fixed; display: none; top: calc(var(--menu-height) + var(--safe-top)); left: 8px; background: linear-gradient(#FFFFFF, #F0F4FA); border: 1px solid #AAB3C2; box-shadow: 0 8px 18px rgba(0,0,0,0.18), inset 0 1px 0 rgba(255,255,255,0.9); border-radius: 6px; padding: 6px 0; z-index: 20; min-width: 180px; }
        .menu-dropdown.open { display: block; }
        .menu-list { list-style: none; margin: 0; padding: 0; }
        .menu-item-row { display: flex; align-items: center; gap: 10px; padding: 4px 14px; font-size: 13px; color: #0B1B3A; white-space: nowrap; }
        .menu-item-row:hover { background: linear-gradient(#5BA1FF, #2D88FF); color: #FFFFFF; }
        .menu-sep { height: 1px; margin: 6px 8px; background: #D3DAE6; }

        /* Desktop selection rectangle */
        .selection-rect { position: fixed; border: 1px solid rgba(45,136,255,0.6); background: rgba(45,136,255,0.15); pointer-events: none; z-index: 3; }
        .icon-item.selected .icon-label { background: linear-gradient(#5BA1FF, #2D88FF); color: #FFFFFF; padding: 2px 4px; border-radius: 4px; }

        /* Aqua Dock */
        .dock {
            position: fixed;
            left: 50%;
            transform: translateX(-50%);
            bottom: calc(10px + var(--safe-bottom));
            background: linear-gradient(180deg, rgba(255,255,255,0.6) 0%, rgba(242,247,255,0.5) 55%, rgba(220,232,248,0.32) 100%);
            border: 1px solid rgba(170, 179, 194, 0.8);
            box-shadow: 0 6px 16px rgba(0,0,0,0.14), inset 0 1px 0 rgba(255,255,255,0.9), inset 0 -4px 8px rgba(0,0,0,0.04);
            border-radius: 14px;
            padding: 6px 10px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            z-index: 6;
            user-select: none;
            -webkit-user-select: none;
            backdrop-filter: saturate(150%) blur(10px);
        }
        .dock::before {
            content: "";
            position: absolute;
            left: 6px; right: 6px; bottom: 4px;
            height: 8px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.45), rgba(255,255,255,0));
            border-radius: 10px;
        }
        .dock::after {
            content: "";
            position: absolute;
            left: 6px; right: 6px; top: 2px;
            height: 4px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.75), rgba(255,255,255,0));
            border-radius: 10px;
            pointer-events: none;
        }
        .dock-item { position: relative; display: inline-flex; align-items: flex-end; justify-content: center; height: 72px; }
        /* Black triangle indicator under open apps (Aqua) */
        .dock-item.active::after { content: ""; position: absolute; bottom: 2px; width: 0; height: 0; border-left: 4px solid transparent; border-right: 4px solid transparent; border-top: 6px solid rgba(0,0,0,0.75); }
        .dock-icon { width: 48px; height: 48px; object-fit: contain; border-radius: 0; border: none; background: transparent; box-shadow: none; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.16)); transform-origin: bottom center; transition: transform 0.08s ease-out; -webkit-box-reflect: below 2px linear-gradient(transparent, rgba(0,0,0,0.12)); }
        .dock-icon.bounce { animation: dock-bounce 0.6s ease-out; }
        @keyframes dock-bounce { 0% { transform: translateY(0) scale(1); } 25% { transform: translateY(-14px) scale(1.05); } 50% { transform: translateY(0) scale(1); } 75% { transform: translateY(-8px) scale(1.03); } 100% { transform: translateY(0) scale(1); } }
        @media (max-width: 520px) {
            .dock { padding: 6px 8px; gap: 8px; }
            .dock-item { height: 60px; }
            .dock-icon { width: 36px; height: 36px; }
        }
        /* Dock hover label */
        .dock-label { position: fixed; padding: 3px 8px; font-size: 11px; color: #0B1B3A; background: linear-gradient(#FFFFFF, #EEF3FA); border: 1px solid #AAB3C2; border-radius: 8px; box-shadow: inset 0 1px 0 rgba(255,255,255,0.9); pointer-events: none; opacity: 0; transition: opacity 120ms ease, transform 120ms ease; z-index: 20; transform: translateY(2px); }
        .dock-label.show { opacity: 1; transform: translateY(0); }
    </style>
    <script
      defer
      data-website-id="dfid_PjaDAvB4f8o8E37vmPqEE"
      data-domain="relative.dev"
      src="https://datafa.st/js/script.js">
    </script>
</head>
<body>
    <div class="menu-bar">
        <div class="menu-left">
            <div class="menu-item apple"></div>
            <div class="menu-item">Relative</div>
            <div class="menu-item menu-extra">File</div>
            <div class="menu-item menu-extra">Edit</div>
            <div class="menu-item menu-extra">View</div>
            <div class="menu-item menu-extra">Special</div>
        </div>
        <div class="menu-right">
            <div class="menu-item clock" id="clock"></div>
        </div>
    </div>

    <div class="menu-dropdown" id="menu-dropdown-apple">
        <ul class="menu-list">
            <li class="menu-item-row" data-open="egg-about">About This Mac…</li>
            <li class="menu-sep"></li>
            <li class="menu-item-row" data-open="egg-prefs">System Preferences…</li>
            <li class="menu-item-row" data-open="egg-apps">Applications</li>
            <li class="menu-item-row" data-open="egg-readme">ReadMe.txt</li>
            <li class="menu-item-row" data-open="egg-quote">Jobs Quote</li>
            <li class="menu-sep"></li>
            <li class="menu-item-row" data-open="egg-trash">Empty Trash</li>
        </ul>
    </div>
    <div class="menu-dropdown" id="menu-dropdown-relative">
        <ul class="menu-list">
            <li class="menu-item-row" data-open="egg-about-panel">About Relative.dev</li>
            <li class="menu-item-row" data-open="egg-finder">Open Finder</li>
            <li class="menu-sep"></li>
            <li class="menu-item-row"><a href="https://x.com/relativedotdev" target="_blank" rel="noopener">X (Twitter)</a></li>
            <li class="menu-item-row"><a href="https://www.linkedin.com/company/relativeindustries" target="_blank" rel="noopener">LinkedIn</a></li>
        </ul>
    </div>
    <div class="menu-dropdown" id="menu-dropdown-edit">
        <ul class="menu-list">
            <li class="menu-item-row" data-action="organize-icons">Organize Icons</li>
        </ul>
    </div>

    <main class="desktop">
        <div class="desktop-header">
            <img class="brand-logo" src="images/relative-industries-logo.svg?v=1" alt="Relative.dev">
            <span class="brand-tagline">AI apps for everyone</span>
        </div>

        <div class="selection-rect" id="selection-rect" style="display:none;"></div>

        <div class="desktop-icons">
            <div class="icon-item" data-id="about" data-target="egg-about" style="left: 16px; top: 88px;">
                <img class="icon-thumb" src="images/finder.png?v=2" alt="About">
                <div class="icon-label">About</div>
            </div>
            <div class="icon-item" data-id="readme" data-target="egg-readme" style="left: 16px; top: 168px;">
                <img class="icon-thumb" src="images/txt.png?v=2" alt="ReadMe.txt">
                <div class="icon-label">ReadMe.txt</div>
            </div>
            <div class="icon-item" data-id="prefs" data-target="egg-chess" style="left: 16px; top: 248px;">
                <img class="icon-thumb" src="images/aqua-chess.svg?v=3" alt="Chess">
                <div class="icon-label">Chess</div>
            </div>
            <div class="icon-item" data-id="apps" data-target="egg-apps" style="left: 16px; top: 328px;">
                <img class="icon-thumb" src="images/folder.png?v=2" alt="Applications">
                <div class="icon-label">Applications</div>
            </div>
            <div class="icon-item" data-id="trash" data-target="egg-trash" style="left: 16px; top: 408px;">
                <img class="icon-thumb" src="images/trash.png?v=2" alt="Trash">
                <div class="icon-label">Trash</div>
            </div>
            <div class="icon-item" data-id="quote" data-target="egg-quote" style="left: 16px; top: 488px;">
                <img class="icon-thumb" src="images/txt.png?v=2" alt="Jobs Quote">
                <div class="icon-label">Jobs</div>
            </div>
            <div class="icon-item" data-id="ipod" data-target="egg-ipod" style="left: 16px; top: 568px;">
                <img class="icon-thumb" src="images/ipod.png?v=2" alt="iPod">
                <div class="icon-label">iPod</div>
            </div>
            <div class="icon-item" data-id="orb" data-target="egg-orb" style="left: 16px; top: 648px;">
                <img class="icon-thumb" src="images/orb.png?v=2" alt="Aqua Orb">
                <div class="icon-label">Orb</div>
            </div>
        </div>

        <section class="windows">
            <div id="win-products" class="window metal draggable" style="left: 220px; top: 160px; width: min(92vw, 560px);">
                <div class="titlebar">
                    <div class="traffic"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
                    <div class="title">Products</div>
                </div>
                <div class="window-content">
                    <div class="list-view">
                        <div class="list-row">
                            <img class="icon" src="images/Hermes-iOS-Default-1024x1024@1x.png" alt="Hermes">
                            <div class="primary"><a href="https://hermesvoice.com" target="_blank" rel="noopener" style="color:inherit; text-decoration:none;">Hermes</a></div>
                            <div class="secondary">AI Voice-to-Text for Every App
                                <div class="actions">
                                    <a class="aqua-btn primary" href="https://hwmeitwlnygrhygsebkx.supabase.co/storage/v1/object/public/Hermes%20App/releases/prod/Hermes-1.0.35.dmg" target="_blank" rel="noopener"> Download for macOS</a>
                                </div>
                            </div>
                        </div>
                        <div class="list-row">
                            <img class="icon" src="images/Cutgun-Share-Banner.jpg" alt="Cutgun">
                            <div class="primary"><a href="https://cutgun.ai" target="_blank" rel="noopener" style="color:inherit; text-decoration:none;">Cutgun</a></div>
                            <div class="secondary">AI Video & Image Studio
                                <div class="actions">
                                    <a class="aqua-btn primary" href="https://cutgun.ai" target="_blank" rel="noopener">Open</a>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>

            <div id="win-creators" class="window draggable" style="left: 820px; top: 160px; width: min(92vw, 520px);">
                <div class="titlebar">
                    <div class="traffic"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
                    <div class="title">Made with ☕ by</div>
                </div>
                <div class="window-content">
                    <div class="people">
                        <a href="https://x.com/adamsenese" target="_blank" class="person">
                            <img class="avatar" src="images/adam-PhotoRoom.png" alt="@adamsenese">
                            <div>
                                <div class="handle">@adamsenese</div>
                                <div class="action">Follow on X</div>
                        </div>
                    </a>
                        <a href="https://x.com/DomTheDev1" target="_blank" class="person">
                            <img class="avatar" src="images/dom-photo.jpg" alt="@DomTheDev1">
                            <div>
                                <div class="handle">@DomTheDev1</div>
                                <div class="action">Follow on X</div>
                        </div>
                    </a>
                    </div>
                </div>
            </div>
        </section>

        <div id="egg-about" class="window modal hidden">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">About This Mac…</div>
            </div>
            <div class="window-content">
                <p style="margin:0 0 8px 0; font-size:13px;">Relative.dev 10.0 (Cheetah)</p>
                <p style="margin:0; font-size:12px; color:#333;">PowerPC G4 • 256 MB SDRAM</p>
            </div>
        </div>

        <div id="egg-readme" class="window modal hidden">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">ReadMe.txt</div>
            </div>
            <div class="window-content">
                <p style="margin:0 0 8px 0; font-size:13px;">Welcome to Relative.dev</p>
                <p style="margin:0; font-size:12px; color:#333;">Drag icons, click to open secret windows. Have fun.</p>
            </div>
        </div>

        <div id="egg-finder" class="window modal hidden metal">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">Finder — Relative</div>
            </div>
            <div class="finder-toolbar">
                <span style="font-size:12px; color:#2B3F5C;">Back ▸</span>
                <span style="font-size:12px; color:#2B3F5C;">View ☐▣▦</span>
                <span style="margin-left:auto; font-size:12px; color:#2B3F5C;">Search</span>
            </div>
            <div class="finder-body">
                <div class="finder-sidebar">
                    <div class="side-item active">All Products</div>
                    <div class="side-item">Favorites</div>
                    <div class="side-item">Creators</div>
                </div>
                <div class="finder-content">
                    <div class="finder-grid">
                        <a href="https://hermesvoice.com" class="finder-item">
                            <img class="icon" src="images/Hermes-iOS-Default-1024x1024@1x.png" alt="Hermes">
                            <div>
                                <div class="primary">Hermes</div>
                                <div class="secondary">AI Voice-to-Text for Every App</div>
                            </div>
                        </a>
                        <a href="https://cutgun.ai" class="finder-item">
                            <img class="icon" src="images/Cutgun-Share-Banner.jpg" alt="Cutgun">
                            <div>
                                <div class="primary">Cutgun</div>
                                <div class="secondary">AI Video & Image Studio</div>
                        </div>
                    </a>
                        
                </div>
            </div>
        </div>
    </div>

        <div id="egg-about-panel" class="window modal hidden">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">About Relative.dev</div>
            </div>
            <div class="window-content">
                <p style="margin:0 0 8px 0; font-size:13px;">Relative.dev builds AI apps for everyone.</p>
                <p style="margin:0; font-size:12px; color:#333;">Crafted with the spirit of Aqua — simple, fun, and usable.</p>
                <hr style="margin:10px 0; border:0; height:1px; background: linear-gradient(90deg, transparent, rgba(0,0,0,0.15), transparent);"/>
                <p style="margin:0; font-size:12px; color:#333;">Relative Industries LLC · <a href="https://x.com/relativedotdev">X</a> · <a href="https://www.linkedin.com/company/relativeindustries">LinkedIn</a></p>
            </div>
        </div>

        <div id="egg-chess" class="window modal hidden">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">Chess</div>
            </div>
            <div class="window-content">
                <div id="chess-board" style="width: min(92vw, 420px); aspect-ratio: 1; display: grid; grid-template-columns: repeat(8, 1fr); grid-template-rows: repeat(8, 1fr); user-select: none; border: 1px solid #A9B4C3; box-shadow: inset 0 1px 0 rgba(255,255,255,0.6); background: #F4F6FA;">
                </div>
                <div style="margin-top: 8px; font-size: 12px; color: #333; display:flex; gap:8px; align-items:center;">
                    <button id="chess-new" style="padding:4px 8px; border:1px solid #A9B4C3; background:#F7FAFF;">New Game</button>
                    <span id="chess-status">White to move</span>
                </div>
            </div>
        </div>

        <div id="egg-prefs" class="window modal hidden metal">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">System Preferences</div>
            </div>
            <div class="window-content">
                <div class="prefs-grid">
                    <a href="#" class="pref-item"><span style="width:16px;height:16px;background:#2D88FF;border-radius:3px;display:inline-block;"></span><div class="text"><div class="label">Appearance</div><div class="desc">Change the look of Aqua</div></div></a>
                    <a href="#" class="pref-item"><span style="width:16px;height:16px;background:#34C84A;border-radius:3px;display:inline-block;"></span><div class="text"><div class="label">Dock</div><div class="desc">Resize and magnify the Dock</div></div></a>
                    <a href="#" class="pref-item"><span style="width:16px;height:16px;background:#E74C3C;border-radius:3px;display:inline-block;"></span><div class="text"><div class="label">Internet</div><div class="desc">Configure your connection</div></div></a>
                    <a href="#" class="pref-item"><span style="width:16px;height:16px;background:#F2B60D;border-radius:3px;display:inline-block;"></span><div class="text"><div class="label">Network</div><div class="desc">Wi‑Fi and Ethernet settings</div></div></a>
                    <a href="#" class="pref-item"><span style="width:16px;height:16px;background:#9B59B6;border-radius:3px;display:inline-block;"></span><div class="text"><div class="label">Speech</div><div class="desc">Text to speech options</div></div></a>
                    <a href="#" class="pref-item"><span style="width:16px;height:16px;background:#16A085;border-radius:3px;display:inline-block;"></span><div class="text"><div class="label">Energy</div><div class="desc">Power and sleep preferences</div></div></a>
                </div>
            </div>
        </div>

        <div id="egg-apps" class="window modal hidden metal">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">Applications</div>
            </div>
            <div class="window-content">
                <div class="apps-grid">
                    <a class="app" href="https://hermesvoice.com" target="_blank" rel="noopener">
                        <img class="icon-thumb" src="images/Hermes-iOS-Default-1024x1024@1x.png" alt="Hermes">
                        <div class="icon-label">Hermes</div>
                        <div class="desc">Voice‑to‑Text for every app</div>
                    </a>
                    <a class="app" href="https://cutgun.ai" target="_blank" rel="noopener">
                        <img class="icon-thumb" src="images/Cutgun-Share-Banner.jpg" alt="Cutgun">
                        <div class="icon-label">Cutgun</div>
                        <div class="desc">AI video & image studio</div>
                    </a>
                    
                </div>
            </div>
        </div>

        <div id="egg-trash" class="window modal hidden">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">Trash</div>
            </div>
            <div class="window-content">
                <p class="trash-note">Trash is empty.</p>
            </div>
        </div>

        <div id="egg-quote" class="window modal hidden">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">Jobs</div>
            </div>
            <div class="window-content">
                <blockquote class="quote">"... it's liquid, one of the design goals was when you saw it you wanted to lick it" — Steve Jobs</blockquote>
                <blockquote class="quote" style="margin-top:8px;">"Stay hungry, stay foolish." — Steve Jobs</blockquote>
                <blockquote class="quote" style="margin-top:8px;">"Innovation distinguishes between a leader and a follower." — Steve Jobs</blockquote>
            </div>
        </div>

        <div id="egg-ipod" class="window modal hidden">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">iPod</div>
            </div>
            <div class="window-content" style="display:flex; gap:12px; align-items:center;">
                <img src="images/ipod.png" alt="iPod" style="width:72px; height:72px; border-radius:10px; border:1px solid #BDBDBD;"/>
                <div>
                    <div class="primary">Click Wheel</div>
                    <div class="secondary">1000 songs in your pocket.</div>
                </div>
            </div>
        </div>

        <div id="egg-orb" class="window modal hidden">
            <div class="titlebar">
                <div class="traffic"><span class="dot close"></span><span class="dot"></span><span class="dot"></span></div>
                <div class="title">Orb</div>
            </div>
            <div class="window-content" style="text-align:center;">
                <img src="images/orb.png" alt="Orb" style="width:80px; height:80px; border-radius:50%; border:1px solid #9FA9B8;"/>
                <p style="font-size:12px; color:#333; margin:8px 0 0;">Sorry, I can't read your future. Please come back later.</p>
            </div>
        </div>
    </main>

    <div id="dock-left-info" class="dock-info">Relative Industries LLC</div>
    <div id="dock-right-info" class="dock-info"><a href="https://x.com/relativedotdev">X</a> · <a href="https://www.linkedin.com/company/relativeindustries">LinkedIn</a></div>

    <div class="dock" id="dock" aria-label="Dock">
        <a href="#" class="dock-item" data-open="egg-finder" aria-label="Finder">
            <img src="images/finder.png?v=2" alt="Finder" class="dock-icon">
        </a>
        <a href="https://hermesvoice.com" target="_blank" rel="noopener" class="dock-item" aria-label="Hermes">
            <img src="images/Hermes-iOS-Default-1024x1024@1x.png?v=2" alt="Hermes" class="dock-icon">
        </a>
        <a href="https://cutgun.ai" target="_blank" rel="noopener" class="dock-item" aria-label="Cutgun">
            <img src="images/Cutgun-Share-Banner.jpg" alt="Cutgun" class="dock-icon">
        </a>
        <a href="#" class="dock-item" data-open="egg-apps" aria-label="Applications">
            <img src="images/folder.png?v=2" alt="Applications" class="dock-icon">
        </a>
        <a href="#" class="dock-item" data-open="egg-ipod" aria-label="iPod">
            <img src="images/ipod.png?v=2" alt="iPod" class="dock-icon">
        </a>
        <a href="#" class="dock-item" data-open="egg-trash" aria-label="Trash">
            <img src="images/trash.png?v=2" alt="Trash" class="dock-icon">
        </a>
    </div>

    <script>
        function updateClock() {
            const el = document.getElementById('clock');
            if (!el) return;
            const now = new Date();
            const day = now.toLocaleDateString(undefined, { weekday: 'short' });
            const time = now.toLocaleTimeString(undefined, { hour: 'numeric', minute: '2-digit' });
            el.textContent = day + ' ' + time;
        }
        updateClock();
        setInterval(updateClock, 30000);

        // Desktop icon dragging and window interactions
        (function() {
            const desktop = document.querySelector('.desktop');
            const icons = Array.from(document.querySelectorAll('.icon-item'));
            let zCounter = 10;
            const saved = JSON.parse(localStorage.getItem('desktopIconPositions') || '{}');

            function clamp(val, min, max) { return Math.max(min, Math.min(max, val)); }

            function applySavedPositions() {
                if (!desktop) return;
                const rect = desktop.getBoundingClientRect();
                let hasAnySaved = false;
                icons.forEach(el => {
                    const id = el.getAttribute('data-id');
                    const pos = saved[id];
                    if (pos) {
                        hasAnySaved = true;
                        el.style.left = clamp(pos.left, 0, rect.width - el.offsetWidth) + 'px';
                        el.style.top = clamp(pos.top, 0, rect.height - el.offsetHeight) + 'px';
                    }
                });
                // Default left alignment for desktop (no saved positions)
                if (!hasAnySaved && !window.matchMedia('(max-width: 520px)').matches) {
                    let top = 88; const left = 16; const vGap = 72;
                    icons.forEach(el => { el.style.left = left + 'px'; el.style.top = top + 'px'; top += vGap; });
                }
            }

            function savePosition(id, left, top) {
                saved[id] = { left, top };
                localStorage.setItem('desktopIconPositions', JSON.stringify(saved));
            }

            function makeDraggable(el) {
                let startX = 0, startY = 0, origLeft = 0, origTop = 0, dragging = false;
                const id = el.getAttribute('data-id');
                const onDown = (e) => {
                    if (!desktop) return;
                    el.setPointerCapture?.(e.pointerId);
                    startX = e.clientX; startY = e.clientY;
                    const style = window.getComputedStyle(el);
                    origLeft = parseFloat(style.left) || 0;
                    origTop = parseFloat(style.top) || 0;
                    dragging = false;
                };
                const onMove = (e) => {
                    if (startX === 0 && startY === 0) return;
                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;
                    if (!dragging && (Math.abs(dx) > 2 || Math.abs(dy) > 2)) dragging = true;
                    if (!dragging) return;
                    const rect = desktop.getBoundingClientRect();
                    const left = clamp(origLeft + dx, 0, rect.width - el.offsetWidth);
                    const top = clamp(origTop + dy, 0, rect.height - el.offsetHeight);
                    el.style.left = left + 'px';
                    el.style.top = top + 'px';
                };
                const onUp = (e) => {
                    if (startX === 0 && startY === 0) return;
                    const rect = desktop.getBoundingClientRect();
                    const style = window.getComputedStyle(el);
                    const left = clamp(parseFloat(style.left) || 0, 0, rect.width - el.offsetWidth);
                    const top = clamp(parseFloat(style.top) || 0, 0, rect.height - el.offsetHeight);
                    savePosition(id, left, top);
                    startX = startY = 0;
                    el.releasePointerCapture?.(e.pointerId);
                    // prevent click only if there was an actual drag
                    if (dragging) {
                        el._dragged = true;
                        setTimeout(() => { el._dragged = false; }, 50);
                    }
                    dragging = false;
                };
                el.addEventListener('pointerdown', onDown);
                window.addEventListener('pointermove', onMove);
                window.addEventListener('pointerup', onUp);
            }

            function focusWindow(win) {
                document.querySelectorAll('.window.modal').forEach(w => {
                    if (w === win) {
                        w.classList.remove('inactive');
                        w.style.zIndex = (++zCounter).toString();
                    } else {
                        w.classList.add('inactive');
                    }
                });
            }
            // expose for dock usage
            window.focusModalWindow = focusWindow;

            function setDockActiveByModalId(id, active) {
                const dockItem = document.querySelector(`.dock .dock-item[data-open="${id}"]`);
                if (dockItem) {
                    dockItem.classList.toggle('active', !!active);
                }
            }

            function setupIconOpens() {
                icons.forEach(el => {
                    el.addEventListener('click', () => {
                        if (el._dragged) return;
                        const targetId = el.getAttribute('data-target');
                        const win = targetId ? document.getElementById(targetId) : null;
                        if (win) {
                            win.classList.remove('hidden');
                            focusWindow(win);
                            setDockActiveByModalId(targetId, true);
                        }
                    });
                });
            }

            function setupWindowClose() {
                document.querySelectorAll('.window.modal .traffic .dot.close').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const win = e.currentTarget.closest('.window.modal');
                        if (win) {
                            win.classList.add('hidden');
                            if (win.id) setDockActiveByModalId(win.id, false);
                        }
                    });
                });
            }

            icons.forEach(makeDraggable);
            applySavedPositions();
            setupIconOpens();
            setupWindowClose();
        })();

        // Dock magnification and interactions
        (function() {
            const dock = document.getElementById('dock');
            if (!dock) return;
            const icons = Array.from(dock.querySelectorAll('.dock-icon'));
            const maxScale = 1.5;
            const influence = 100; // px influence radius around cursor
            let isMobile = window.matchMedia('(max-width: 520px)').matches;

            function magnify(clientX) {
                const dockRect = dock.getBoundingClientRect();
                icons.forEach(img => {
                    const r = img.getBoundingClientRect();
                    const centerX = r.left + r.width / 2;
                    const dist = Math.abs(clientX - centerX);
                    const factor = Math.max(0, 1 - Math.pow(dist / influence, 2)); // smoother curve
                    const scale = 1 + factor * (maxScale - 1);
                    img.style.transform = `translateY(${(-6 * factor).toFixed(1)}px) scale(${scale.toFixed(3)})`;
                });
            }

            function reset() { icons.forEach(img => { img.style.transform = 'translateY(0) scale(1)'; }); }

            if (!isMobile) {
                dock.addEventListener('mousemove', (e) => magnify(e.clientX));
                dock.addEventListener('mouseleave', () => { reset(); if (label) label.classList.remove('show'); });
            }

            dock.addEventListener('click', (e) => {
                const icon = e.target.closest('.dock-icon');
                if (!icon) return;
                icon.classList.remove('bounce');
                // force reflow to restart animation
                void icon.offsetWidth;
                icon.classList.add('bounce');

                const item = e.target.closest('.dock-item');
                const openId = item && item.getAttribute('data-open');
                if (openId) {
                    e.preventDefault();
                    const win = document.getElementById(openId);
                    if (win) {
                        win.classList.remove('hidden');
                        // reuse focusWindow from prior IIFE
                        if (typeof window.focusModalWindow === 'function') {
                            window.focusModalWindow(win);
                        } else {
                            // fallback: bring to front
                            win.style.zIndex = '999';
                        }
                        item.classList.add('active');
                    }
                } else {
                    // Treat external app icons as active once launched
                    item.classList.add('active');
                }
            });

            // Hover labels above icons
            let label = document.createElement('div');
            label.className = 'dock-label';
            document.body.appendChild(label);
            dock.addEventListener('mousemove', (e) => {
                const item = e.target.closest('.dock-item');
                if (!item) return;
                const aria = item.getAttribute('aria-label') || item.querySelector('.dock-icon')?.getAttribute('alt') || '';
                if (!aria) return;
                label.textContent = aria;
                const r = item.getBoundingClientRect();
                label.style.left = (r.left + r.width/2 - label.offsetWidth/2) + 'px';
                // Prefer below the icon, but clamp within viewport; if no room, place above
                const desiredBelow = r.bottom + 6;
                const maxTop = window.innerHeight - label.offsetHeight - 6;
                const top = desiredBelow <= maxTop ? desiredBelow : (r.top - label.offsetHeight - 6);
                label.style.top = top + 'px';
                label.classList.add('show');
            });

            // Position dock overlay info boxes relative to Dock
            const leftInfo = document.getElementById('dock-left-info');
            const rightInfo = document.getElementById('dock-right-info');
            function placeOverlays(){
                if (!leftInfo || !rightInfo) return;
                const r = dock.getBoundingClientRect();
                const bottom = (window.innerHeight - r.top) + 8; // 8px above dock top
                leftInfo.style.left = Math.max(8, r.left) + 'px';
                leftInfo.style.bottom = bottom + 'px';
                rightInfo.style.left = Math.max(8, r.right - rightInfo.offsetWidth) + 'px';
                rightInfo.style.bottom = bottom + 'px';
            }
            placeOverlays();
            window.addEventListener('resize', placeOverlays);
        })();

        // Menus and selection rectangle
        (function() {
            const menuBar = document.querySelector('.menu-bar');
            const menus = {
                apple: document.getElementById('menu-dropdown-apple'),
                relative: document.getElementById('menu-dropdown-relative'),
                edit: document.getElementById('menu-dropdown-edit')
            };
            const desktop = document.querySelector('.desktop');
            const selection = document.getElementById('selection-rect');
            const icons = Array.from(document.querySelectorAll('.desktop .icon-item'));
            let menuOpen = false;

            function closeAllMenus(){
                document.querySelectorAll('.menu-dropdown.open').forEach(m=>m.classList.remove('open'));
                menuOpen = false;
            }
            function openMenuEl(el, x, y){
                if (!el) return;
                closeAllMenus();
                el.style.left = Math.max(8, (x || 8)) + 'px';
                el.classList.add('open');
                menuOpen = true;
            }

            // Apple, Relative, and Edit open their respective menus
            menuBar.addEventListener('click', (e) => {
                const item = e.target.closest('.menu-item');
                if (!item) return;
                const label = item.textContent.trim();
                const rect = item.getBoundingClientRect();
                if (label === '') return openMenuEl(menus.apple, rect.left, rect.bottom);
                if (label === 'Relative') return openMenuEl(menus.relative, rect.left, rect.bottom);
                if (label === 'Edit') return openMenuEl(menus.edit, rect.left, rect.bottom);
            });
            document.addEventListener('click', (e) => {
                const anyOpen = document.querySelector('.menu-dropdown.open');
                if (anyOpen && !anyOpen.contains(e.target) && !menuBar.contains(e.target)) closeAllMenus();
            });
            function handleMenuClick(e) {
                const row = e.target.closest('.menu-item-row');
                if (!row) return;
                const id = row.getAttribute('data-open');
                const action = row.getAttribute('data-action');
                if (action === 'organize-icons') {
                    // Snap icons to a tidy left-to-right grid and clear saved positions
                    const desktop = document.querySelector('.desktop');
                    const icons = Array.from(document.querySelectorAll('.desktop .icon-item'));
                    if (desktop && icons.length) {
                        const rect = desktop.getBoundingClientRect();
                        const marginLeft = 16;
                        const marginTop = 88;
                        const xStep = 96;  // horizontal spacing
                        const yStep = 84;  // vertical spacing
                        const bottomGuard = 140; // keep space above dock
                        let x = marginLeft;
                        let y = marginTop;
                        icons.forEach(el => {
                            const h = el.offsetHeight || 72;
                            if (y + h + 10 > rect.height - bottomGuard) { x += xStep; y = marginTop; }
                            el.style.left = x + 'px';
                            el.style.top = y + 'px';
                            y += yStep;
                        });
                        localStorage.removeItem('desktopIconPositions');
                    }
                    closeAllMenus();
                    return;
                }
                if (id) {
                    const win = document.getElementById(id);
                    if (win) {
                        win.classList.remove('hidden');
                        if (typeof window.focusModalWindow === 'function') window.focusModalWindow(win);
                    }
                }
                closeAllMenus();
            }
            Object.values(menus).forEach(m => m && m.addEventListener('click', handleMenuClick));

            // Desktop selection rectangle for icons
            let startX = 0, startY = 0, selecting = false;
            desktop.addEventListener('pointerdown', (e) => {
                // ignore when clicking on windows, icons, dock, or menus
                if (e.target.closest('.window') || e.target.closest('.icon-item') || e.target.closest('.dock') || e.target.closest('.menu-dropdown') || e.target.closest('.menu-bar')) return;
                startX = e.clientX; startY = e.clientY; selecting = true;
                selection.style.left = startX + 'px';
                selection.style.top = startY + 'px';
                selection.style.width = '0px';
                selection.style.height = '0px';
                selection.style.display = 'block';
                icons.forEach(i => i.classList.remove('selected'));
            });
            window.addEventListener('pointermove', (e) => {
                if (!selecting) return;
                const x = Math.min(e.clientX, startX);
                const y = Math.min(e.clientY, startY);
                const w = Math.abs(e.clientX - startX);
                const h = Math.abs(e.clientY - startY);
                selection.style.left = x + 'px';
                selection.style.top = y + 'px';
                selection.style.width = w + 'px';
                selection.style.height = h + 'px';
                const selRect = selection.getBoundingClientRect();
                icons.forEach(icon => {
                    const r = icon.getBoundingClientRect();
                    const overlap = !(selRect.right < r.left || selRect.left > r.right || selRect.bottom < r.top || selRect.top > r.bottom);
                    icon.classList.toggle('selected', overlap);
                });
            });
            window.addEventListener('pointerup', () => {
                if (!selecting) return;
                selecting = false;
                selection.style.display = 'none';
            });
        })();

        // Draggable windows (Products and Creators)
        (function() {
            const container = document.querySelector('.desktop');
            if (!container) return;
            const wins = Array.from(document.querySelectorAll('.window.draggable'));
            const saved = JSON.parse(localStorage.getItem('draggableWindowPositions') || '{}');
            let zTop = 50;
            function clamp(val, min, max) { return Math.max(min, Math.min(max, val)); }
            function applySaved(win){
                const id = win.id; if (!id) return; const pos = saved[id]; if (!pos) return;
                const rect = container.getBoundingClientRect();
                win.style.left = clamp(pos.left, 0, rect.width - win.offsetWidth) + 'px';
                win.style.top = clamp(pos.top, 0, rect.height - win.offsetHeight) + 'px';
            }
            function save(win){ const id = win.id; if (!id) return; const style = getComputedStyle(win); saved[id] = { left: parseFloat(style.left)||0, top: parseFloat(style.top)||0 }; localStorage.setItem('draggableWindowPositions', JSON.stringify(saved)); }
            wins.forEach(win => {
                applySaved(win);
                const handle = win.querySelector('.titlebar'); if (!handle) return;
                let sx=0, sy=0, sl=0, st=0, dragging=false;
                handle.addEventListener('pointerdown', (e)=>{
                    if (window.matchMedia('(max-width: 840px)').matches) return;
                    sx=e.clientX; sy=e.clientY; const cs=getComputedStyle(win); sl=parseFloat(cs.left)||0; st=parseFloat(cs.top)||0; dragging=true; win.style.zIndex=(++zTop).toString(); handle.setPointerCapture?.(e.pointerId);
                });
                window.addEventListener('pointermove', (e)=>{
                    if (!dragging) return; const rect = container.getBoundingClientRect();
                    const nl = clamp(sl + (e.clientX - sx), 0, rect.width - win.offsetWidth);
                    const nt = clamp(st + (e.clientY - sy), 0, rect.height - win.offsetHeight);
                    win.style.left = nl + 'px'; win.style.top = nt + 'px';
                });
                window.addEventListener('pointerup', (e)=>{ if (!dragging) return; dragging=false; save(win); handle.releasePointerCapture?.(e.pointerId); });
            });
        })();

        // Chess game (simple rules, random-move bot for black)
        (function() {
            const boardEl = document.getElementById('chess-board');
            if (!boardEl) return;
            const statusEl = document.getElementById('chess-status');
            const newBtn = document.getElementById('chess-new');

            // Unicode pieces
            const sym = { K:'\u2654', Q:'\u2655', R:'\u2656', B:'\u2657', N:'\u2658', P:'\u2659',
                          k:'\u265A', q:'\u265B', r:'\u265C', b:'\u265D', n:'\u265E', p:'\u265F' };

            // Initial board (white bottom, a1 bottom-left)
            const start = (
                'rnbqkbnr' +
                'pppppppp' +
                '........' +
                '........' +
                '........' +
                '........' +
                'PPPPPPPP' +
                'RNBQKBNR'
            ).split('');

            let board = start.slice();
            let turn = 'w';
            let sel = -1;
            let targets = [];

            function idxToRC(i){ return { r: Math.floor(i/8), c: i%8 }; }
            function rcToIdx(r,c){ return r*8+c; }
            function inBounds(r,c){ return r>=0&&r<8&&c>=0&&c<8; }
            function isWhite(ch){ return ch>='A' && ch<='Z'; }
            function isBlack(ch){ return ch>='a' && ch<='z'; }

            function render() {
                boardEl.innerHTML='';
                for (let i=0;i<64;i++) {
                    const {r,c}=idxToRC(i);
                    const sq=document.createElement('div');
                    sq.className = 'chess-square ' + ((r+c)%2===0?'light':'dark');
                    if (i===sel) sq.classList.add('sel');
                    if (targets.includes(i)) {
                        sq.classList.add('target');
                        if (board[i]!=='.') sq.classList.add('capture');
                        sq.classList.add('can-move');
                    }
                    const p=board[i];
                    if (p!=='.') sq.textContent = sym[p];
                    sq.dataset.idx=i;
                    boardEl.appendChild(sq);
                }
                markLast();
            }

            function addMove(moves, fromR, fromC, toR, toC, color) {
                if (!inBounds(toR,toC)) return false;
                const to = rcToIdx(toR,toC);
                const ch = board[to];
                if (ch==='.') { moves.push({from:rcToIdx(fromR,fromC), to}); return true; }
                if (color==='w' && isBlack(ch)) { moves.push({from:rcToIdx(fromR,fromC), to}); return false; }
                if (color==='b' && isWhite(ch)) { moves.push({from:rcToIdx(fromR,fromC), to}); return false; }
                return false;
            }

            function pseudoMovesFor(idx, colorFilter) {
                const moves=[]; const {r,c}=idxToRC(idx); const p=board[idx]; if (p==='.') return moves;
                const color = isWhite(p)?'w':'b';
                if (colorFilter && color!==colorFilter) return moves;
                const dir = color==='w'?-1:1;
                switch (p.toLowerCase()) {
                    case 'p': {
                        const f1=rcToIdx(r+dir,c); if (inBounds(r+dir,c) && board[f1]==='.') moves.push({from:idx,to:f1});
                        // double
                        const startRank = color==='w'?6:1; const f2=rcToIdx(r+2*dir,c);
                        if (r===startRank && board[f1]==='.' && board[f2]==='.') moves.push({from:idx,to:f2});
                        // captures
                        [[dir,-1],[dir,1]].forEach(([dr,dc])=>{
                            const tr=r+dr, tc=c+dc; if (!inBounds(tr,tc)) return; const to=rcToIdx(tr,tc); const ch=board[to];
                            if (color==='w' && isBlack(ch)) moves.push({from:idx,to});
                            if (color==='b' && isWhite(ch)) moves.push({from:idx,to});
                        });
                        break;
                    }
                    case 'n': {
                        [[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]].forEach(([dr,dc])=>{
                            addMove(moves,r,c,r+dr,c+dc,color);
                        });
                        break;
                    }
                    case 'b': {
                        [[-1,-1],[-1,1],[1,-1],[1,1]].forEach(([dr,dc])=>{
                            let tr=r+dr, tc=c+dc; while(inBounds(tr,tc)) { if(!addMove(moves,r,c,tr,tc,color)) break; tr+=dr; tc+=dc; }
                        });
                        break;
                    }
                    case 'r': {
                        [[-1,0],[1,0],[0,-1],[0,1]].forEach(([dr,dc])=>{
                            let tr=r+dr, tc=c+dc; while(inBounds(tr,tc)) { if(!addMove(moves,r,c,tr,tc,color)) break; tr+=dr; tc+=dc; }
                        });
                        break;
                    }
                    case 'q': {
                        [[-1,-1],[-1,1],[1,-1],[1,1],[-1,0],[1,0],[0,-1],[0,1]].forEach(([dr,dc])=>{
                            let tr=r+dr, tc=c+dc; while(inBounds(tr,tc)) { if(!addMove(moves,r,c,tr,tc,color)) break; tr+=dr; tc+=dc; }
                        });
                        break;
                    }
                    case 'k': {
                        [[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]].forEach(([dr,dc])=>{
                            addMove(moves,r,c,r+dr,c+dc,color);
                        });
                        break;
                    }
                }
                return moves;
            }

            function findKing(color, b=board){
                const target = color==='w' ? 'K' : 'k';
                for (let i=0;i<64;i++) if (b[i]===target) return i; return -1;
            }
            function squareAttacked(idx, byColor, b=board){
                const {r,c}=idxToRC(idx);
                // pawns
                const dir = byColor==='w'?-1:1;
                for (const dc of [-1,1]){ const rr=r+dir, cc=c+dc; if (inBounds(rr,cc)) { const ch=b[rcToIdx(rr,cc)]; if (byColor==='w' && ch==='P') return true; if (byColor==='b' && ch==='p') return true; } }
                // knights
                for (const [dr,dc] of [[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]]) { const rr=r+dr, cc=c+dc; if (!inBounds(rr,cc)) continue; const ch=b[rcToIdx(rr,cc)]; if (byColor==='w' && ch==='N') return true; if (byColor==='b' && ch==='n') return true; }
                // bishops/queens
                for (const [dr,dc] of [[-1,-1],[-1,1],[1,-1],[1,1]]) { let rr=r+dr, cc=c+dc; while(inBounds(rr,cc)){ const ch=b[rcToIdx(rr,cc)]; if (ch!=='.'){ if (byColor==='w' && (ch==='B'||ch==='Q')) return true; if (byColor==='b' && (ch==='b'||ch==='q')) return true; break; } rr+=dr; cc+=dc; } }
                // rooks/queens
                for (const [dr,dc] of [[-1,0],[1,0],[0,-1],[0,1]]) { let rr=r+dr, cc=c+dc; while(inBounds(rr,cc)){ const ch=b[rcToIdx(rr,cc)]; if (ch!=='.'){ if (byColor==='w' && (ch==='R'||ch==='Q')) return true; if (byColor==='b' && (ch==='r'||ch==='q')) return true; break; } rr+=dr; cc+=dc; } }
                // king
                for (const [dr,dc] of [[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]]) { const rr=r+dr, cc=c+dc; if (!inBounds(rr,cc)) continue; const ch=b[rcToIdx(rr,cc)]; if (byColor==='w' && ch==='K') return true; if (byColor==='b' && ch==='k') return true; }
                return false;
            }
            function inCheck(color, b=board){ const k = findKing(color,b); if (k<0) return true; const opp = color==='w'?'b':'w'; return squareAttacked(k, opp, b); }
            function doMove(b, m){ const nb=b.slice(); nb[m.to]=nb[m.from]; nb[m.from]='.'; return nb; }
            function legalMoves(color){
                const res=[]; for (let i=0;i<64;i++){ const p=board[i]; if (p==='.') continue; if ((color==='w'&&isWhite(p))||(color==='b'&&isBlack(p))) {
                    const pseudo = pseudoMovesFor(i, color);
                    for (const m of pseudo){ const nb=doMove(board,m); if (!inCheck(color, nb)) res.push(m); }
                } }
                return res;
            }

            let lastMove = null;
            function move(m){ board[m.to]=board[m.from]; board[m.from]='.'; lastMove=m; }

            function markLast(){
                if (!lastMove) return;
                Array.from(boardEl.children).forEach((sq,idx)=>{
                    if (idx===lastMove.from || idx===lastMove.to) sq.classList.add('last');
                });
            }
            function botMove(){
                const moves = legalMoves('b');
                if (moves.length===0) { statusEl.textContent = 'Game over'; return; }
                const m = moves[Math.floor(Math.random()*moves.length)];
                move(m); turn='w'; statusEl.textContent='White to move'; render(); markLast();
            }

            boardEl.addEventListener('click', (e)=>{
                const sq = e.target.closest('.chess-square'); if (!sq) return; const i = parseInt(sq.dataset.idx,10);
                if (sel===-1) {
                    const p=board[i]; if (p==='.') return; if ((turn==='w' && !isWhite(p)) || (turn==='b' && !isBlack(p))) return;
                    sel=i; targets=legalMoves('w').filter(m=>m.from===i).map(m=>m.to); render();
                } else {
                    if (i===sel) { sel=-1; targets=[]; render(); return; }
                    if (targets.includes(i)) {
                        const mAll = legalMoves('w');
                        const m = mAll.find(x=>x.from===sel && x.to===i);
                        if (m) { move(m); sel=-1; targets=[]; turn='b'; statusEl.textContent='Black thinking…'; render();
                            const fromEl = boardEl.children[lastMove.from]; const toEl = boardEl.children[lastMove.to];
                            if (fromEl) fromEl.classList.add('moved'); if (toEl) toEl.classList.add('moved');
                            // Checkmate or stalemate detection before bot moves
                            const oppMoves = legalMoves('b');
                            if (oppMoves.length===0){ if (inCheck('b')) { statusEl.textContent='Checkmate — White wins'; } else { statusEl.textContent='Stalemate'; } return; }
                            setTimeout(()=>{
                                // Bot move then check endgame for white
                                botMove();
                                const myMoves = legalMoves('w');
                                if (myMoves.length===0){ if (inCheck('w')) { statusEl.textContent='Checkmate — Black wins'; } else { statusEl.textContent='Stalemate'; } }
                            }, 350);
                        }
                    } else { sel=-1; targets=[]; render(); }
                }
            });

            // Hover preview
            boardEl.addEventListener('mousemove', (e)=>{
                const sq = e.target.closest('.chess-square');
                Array.from(boardEl.children).forEach(s=>s.classList.remove('hover'));
                if (!sq) return; sq.classList.add('hover');
            });
            boardEl.addEventListener('pointerdown', (e)=>{
                const sq = e.target.closest('.chess-square'); if (!sq) return; sq.classList.add('grab');
            });
            boardEl.addEventListener('pointerup', (e)=>{
                Array.from(boardEl.children).forEach(s=>s.classList.remove('grab'));
            });

            function reset(){ board=start.slice(); turn='w'; sel=-1; targets=[]; statusEl.textContent='White to move'; render(); }
            newBtn.addEventListener('click', reset);

            // Ensure chess icon opens chess modal (in case of earlier mapping)
            const chessIcon = Array.from(document.querySelectorAll('.icon-item .icon-label')).find(el=>el.textContent.trim()==='Chess');
            if (chessIcon) {
                const holder = chessIcon.closest('.icon-item');
                if (holder) holder.setAttribute('data-target','egg-chess');
            }

            render();
        })();
        </script>
</body>
</html>
